1                                                          The SAS System                           05:36 Monday, September 14, 2020

NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6) 
      Licensed to 19W30_FASHBI, Site 70068130.
NOTE: This session is executing on the X64_DSRV16  platform.



NOTE: Analytical products:
      
      SAS/STAT 15.1
      SAS/ETS 15.1
      SAS/OR 15.1
      SAS/QC 15.1

NOTE: Additional host information:

 X64_DSRV16 WIN 10.0.14393  Server

NOTE: SAS initialization used:
      real time           0.08 seconds
      cpu time            0.09 seconds
      
NOTE: Libref SASDATA successfully assigned from logical server.
NOTE: Libref WRSDIST successfully assigned from logical server.
NOTE: Libref WRSTEMP successfully assigned from logical server.
NOTE: Libref VALIB successfully assigned from logical server.
NOTE: Libref PMMODEL successfully assigned from logical server.
NOTE: Libref STPSAMP successfully assigned from logical server.

NOTE: AUTOEXEC processing beginning; file is D:\SAS\Config\Lev1\SASApp\BatchServer\autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          proc datasets lib=mst_prep nolist nowarn;
ERROR: Libref MST_PREP is not assigned.
2           delete CC_INACTIVE_PARTY_TRANSACTION;
3           quit;

NOTE: Statements not processed because of errors noted above.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: Due to ERROR(s) above, SAS set option OBS=0, enabling syntax check mode. 
      This prevents execution of subsequent data modification statements.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      
4          
5          /*----------------------------------
6           * Create CC_INACTIVE_PARTY_TRANSACTION view
7           *----------------------------------*/
8           %macro fcf_create_pty_trans_view;
9          
10            /* Determine number of days to chain daily prep files together.*/
11              proc sql noprint;
12                 select max(input(sp.parm_value,best32.)) into :numdays
13                   from seg_kc.fsk_header h,
14                        seg_kc.fsk_scenario s,
2                                                          The SAS System                           05:36 Monday, September 14, 2020

15                        seg_kc.fsk_scenario_parameter sp
16                  where h.header_id=s.header_id and
17                        upcase(h.denorm_table_name) = "CC_INACTIVE_PARTY_TRANSACTION" and
18                        upcase(s.scenario_status_code) = "ACT" and
19                        upcase(s.current_ind) = "Y" and
20                        upcase(s.logical_delete_ind) ne 'Y' and
21                        s.scenario_id = sp.scenario_id and
22                        sp.parm_name like 'p%_num_days'
23                        ;
24              quit;
25              %let numdays=&numdays;  /*trim blanks*/
26              /*Some scenarios don't have a num_days parameter
27                but still need one day of transactions.*/
28              %if &numdays eq . %then %let numdays = 1;
29              %put Inactive Party numdays: &numdays;
30         
31          /*----------------
32           * Get date range
33           *----------------*/
34          data _null_;
35            x = input(put(&runasofdate,8.),yymmdd8.) - &numdays -5 +1;
36            call symput('pBeginDate',kcompress(put(x,yymmdd10.),'-'));
37           run;
38         %put &pBeginDate;
39         	proc sql;
40         	create table mst_prep.CC_INACTIVE_PARTY_TRANSACTION as
41             select
42                       A.account_number,
43                       B.party_number,
44         			  input(put(I.date_key,8.),yymmdd8.) as date_key format=yymmdd8. length=5,
45         			  B.customer_risk_category,
46         			  C.transaction_cdi_code,
47                       C.primary_medium_desc,
48                       F.currency_code,
49                       I.currency_amount,
50                       I.transaction_key
51         			  from
52                       seg_kc.fsc_account_dim A,
53                       seg_kc.fsc_party_dim B,
54                       seg_kc.fsc_transaction_type_dim C,
55                       seg_kc.fsc_currency_dim F,
56                       seg_kc.fsc_party_account_bridge H,
57                       seg_kc.fsc_cash_flow_fact I
58                       where
59                       I.account_key = A.account_key and
60                       A.account_key = H.account_key and
61                       B.party_key = H.party_key and
62                       I.transaction_type_key = C.transaction_type_key and
63                       I.transaction_currency_key = F.currency_key and
64         			  I.date_key <= &runasofdate and
65                  	  I.date_key >= &pBeginDate and
66                       H.role_key = 1 and
67                       H.change_current_ind = 'Y'
68         			order by party_number,date_key;
69         	QUIT;
70         	%mend fcf_create_pty_trans_view;
71         	%fcf_create_pty_trans_view;

3                                                          The SAS System                           05:36 Monday, September 14, 2020


NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
ERROR: Libref SEG_KC is not assigned.
ERROR: Libref SEG_KC is not assigned.
ERROR: Libref SEG_KC is not assigned.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
WARNING: Apparent symbolic reference NUMDAYS not resolved.
ERROR: The text expression &NUMDAYS contains a recursive reference to the macro variable NUMDAYS.  The macro variable will be 
       assigned the null value.
Inactive Party numdays:


NOTE: Line generated by the invoked macro "FCF_CREATE_PTY_TRANS_VIEW".
71              data _null_;    x = input(put(&runasofdate,8.),yymmdd8.) - &numdays -5 +1;    call
                                              _
                                              22
71       ! symput('pBeginDate',kcompress(put(x,yymmdd10.),'-'));   run;
WARNING: Apparent symbolic reference RUNASOFDATE not resolved.

ERROR 22-322: Syntax error, expecting one of the following: a name, a quoted string, a numeric constant, a datetime constant, 
              a missing value, INPUT, PUT.  

NOTE: The SAS System stopped processing this step because of errors.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

WARNING: Apparent symbolic reference PBEGINDATE not resolved.
&pBeginDate
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
NOTE 137-205: Line generated by the invoked macro "FCF_CREATE_PTY_TRANS_VIEW".
71                        A.account_key = H.account_key and               B.party_key = H.party_key and
71       ! I.transaction_type_key = C.transaction_type_key and               I.transaction_currency_key = F.currency_key and
71       ! I.date_key <= &runasofdate
                         _
                         22
ERROR 22-322: Syntax error, expecting one of the following: a name, a quoted string, a numeric constant, a datetime constant, 
              a missing value, BTRIM, INPUT, PUT, SUBSTRING, USER.  

WARNING: Apparent symbolic reference RUNASOFDATE not resolved.
NOTE 137-205: Line generated by the invoked macro "FCF_CREATE_PTY_TRANS_VIEW".
71          and             I.date_key >= &pBeginDate and               H.role_key = 1 and               H.change_current_ind = 'Y'
                                          _
                                          22
71       !    order by party_number,date_key;  QUIT;
ERROR 22-322: Syntax error, expecting one of the following: a name, a quoted string, a numeric constant, a datetime constant, 
              a missing value, BTRIM, INPUT, PUT, SUBSTRING, USER.  

WARNING: Apparent symbolic reference PBEGINDATE not resolved.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
4                                                          The SAS System                           05:36 Monday, September 14, 2020

      


ERROR: Errors printed on pages 1,3.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           0.22 seconds
      cpu time            0.15 seconds
      
