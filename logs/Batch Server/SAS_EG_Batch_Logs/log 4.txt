1                                                          The SAS System                            14:22 Wednesday, August 4, 2021

1          ;*';*";*/;quit;run;
2          OPTIONS PAGENO=MIN;
3          %LET _CLIENTTASKLABEL='Program';
4          %LET _CLIENTPROCESSFLOWNAME='Process Flow';
5          %LET _CLIENTPROJECTPATH='S:\corp\E-Commerce\Marketing\2021\Email\Targeting code\08 August\08.15\Mystery
5        ! Package\POD_MYSTERY_SA.egp';
6          %LET _CLIENTPROJECTPATHHOST='SPC110JR6';
7          %LET _CLIENTPROJECTNAME='POD_MYSTERY_SA.egp';
8          %LET _SASPROGRAMFILE='';
9          %LET _SASPROGRAMFILEHOST='';
10         
11         ODS _ALL_ CLOSE;
12         OPTIONS DEV=SVG;
13         GOPTIONS XPIXELS=0 YPIXELS=0;
14         %macro HTML5AccessibleGraphSupported;
15             %if %_SAS_VERCOMP(9, 4, 4) >= 0 %then ACCESSIBLE_GRAPH;
16         %mend;
17         FILENAME EGHTML TEMP;
18         ODS HTML5(ID=EGHTML) FILE=EGHTML
19             OPTIONS(BITMAP_MODE='INLINE')
20             %HTML5AccessibleGraphSupported
21             ENCODING='utf-8'
22             STYLE=HTMLBlue
23             NOGTITLE
24             NOGFOOTNOTE
25             GPATH=&sasworklocation
26         ;
NOTE: Writing HTML5(EGHTML) Body file: EGHTML
27         FILENAME EGSR TEMP;
28         ODS tagsets.sasreport13(ID=EGSR) FILE=EGSR
29             STYLE=HTMLBlue
30             NOGTITLE
31             NOGFOOTNOTE
32             GPATH=&sasworklocation
33             ENCODING=UTF8
34             options(rolap="on")
35         ;
NOTE: Writing TAGSETS.SASREPORT13(EGSR) Body file: EGSR
36         
37         
38         libname BQ_LIB bigquery project="kohls-bda-mkt-prd"
39         	schema="dp_marketing_stage"
40         	insertbuff=32000
41         	MAX_CHAR_LEN=1000
42         	credfile="/srv/prop/config/security/sas_BQ_credentials.json";
NOTE: Libref BQ_LIB was successfully assigned as follows: 
      Engine:        BIGQUERY 
      Physical Name: kohls-bda-mkt-prd
43         
44         proc append base=BQ_LIB.bqts_mktg_pers_offers (bulkload = yes)
45         data=WORK.SEG_INPUT1 force;
46         run;

NOTE: Appending WORK.SEG_INPUT1 to BQ_LIB.bqts_mktg_pers_offers.
WARNING: Variable customer_id_value has different lengths on BASE and DATA files (BASE 1000 DATA 500).
WARNING: Variable customer_id_type has different lengths on BASE and DATA files (BASE 1000 DATA 10).
WARNING: Variable offer_type has different lengths on BASE and DATA files (BASE 1000 DATA 3).
WARNING: Variable offer_name has different lengths on BASE and DATA files (BASE 1000 DATA 7).
2                                                          The SAS System                            14:22 Wednesday, August 4, 2021

WARNING: Variable offer_value has different lengths on BASE and DATA files (BASE 1000 DATA 5).
WARNING: Variable event_id has different lengths on BASE and DATA files (BASE 1000 DATA 5).
WARNING: Variable promo_code has different lengths on BASE and DATA files (BASE 1000 DATA 13).
WARNING: Variable pin_value was not found on DATA file.
WARNING: Variable omni_ind was not found on DATA file.
WARNING: Variable offer_event_name has different lengths on BASE and DATA files (BASE 1000 DATA 13).
WARNING: Variable segment_attr1 was not found on DATA file.
WARNING: Variable segment_attr2 has different lengths on BASE and DATA files (BASE 1000 DATA 7).
WARNING: Variable segment_attr3 has different lengths on BASE and DATA files (BASE 1000 DATA 25).
WARNING: Variable segment_attr4 was not found on DATA file.
WARNING: Variable segment_attr5 was not found on DATA file.
NOTE: There were 40436759 observations read from the data set WORK.SEG_INPUT1.
NOTE: 40436759 observations added.
NOTE: The data set BQ_LIB.bqts_mktg_pers_offers has . observations and 18 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           15:30.66
      cpu time            9:33.18
      

47         proc sql;
48         create table work.cnt_Ag as
49         select count(*) as Total_Records, 'Netezza_Count' as flg, &ofr_ev_nm. as segment_name from work.seg_input1
50         union all
51         select count(*) as Total_Records, 'BQ_Count' as flg, &ofr_ev_nm. as segment_name from BQ_LIB.bqts_mktg_pers_offers
52         where offer_event_name = &ofr_ev_nm.
53         
54         ;
NOTE: Table WORK.CNT_AG created, with 2 rows and 3 columns.

55         quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.91 seconds
      cpu time            0.02 seconds
      

56         
57         
58         filename myemail email
59                  from='Adobe SAS Segmentation Process <tk77693@KOHLS.COM>'
60                  to=(&eml_crm.)
61                  subject="Adobe SAS Segmentation (Personalized Offer) successfully complete for &ofr_ev_nm.: "
62                  content_type = "text/html";
63         		 ODS LISTING CLOSE;
64         		 ODS HTML BODY=myemail ;
NOTE: Writing HTML Body file: MYEMAIL
65         
66         proc sql;
67         title "Count check between Netezza and BQ for Offer Event name: &ofr_ev_nm.";
68         select * from work.cnt_Ag;
69         quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.02 seconds
      cpu time            0.02 seconds
      

70         
71         proc sql;
72         select
3                                                          The SAS System                            14:22 Wednesday, August 4, 2021

73         count(*) as no_of_records,
74         offer_value,
75         segment_attr2,
76         segment_attr3
77         from
78         work.SEG_INPUT1
79         group by offer_value,segment_attr2, segment_attr3
80         order by offer_value, segment_attr2, segment_attr3
81         ;
82         run;
NOTE: PROC SQL statements are executed immediately; The RUN statement has no effect.
83         
84         ods html close;
Message sent
      To:          'rohit.srivatsava@kohls.com' 'mk-mi-email@kohls.com'
      Cc:          
      Bcc:         
      Subject:     Adobe SAS Segmentation (Personalized Offer) successfully complete for 'Mystery_08Aug': 
      Attachments: 
85         ODS LISTING;
86         
87         
88         %LET _CLIENTTASKLABEL=;
89         %LET _CLIENTPROCESSFLOWNAME=;
90         %LET _CLIENTPROJECTPATH=;
91         %LET _CLIENTPROJECTPATHHOST=;
92         %LET _CLIENTPROJECTNAME=;
93         %LET _SASPROGRAMFILE=;
94         %LET _SASPROGRAMFILEHOST=;
95         
96         ;*';*";*/;quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           15.10 seconds
      cpu time            32.82 seconds
      

96       !                run;
97         ODS _ALL_ CLOSE;
98         
99         
100        QUIT; RUN;
101        
